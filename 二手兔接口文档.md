# 					**二手兔-接口文档**

| 作者   | 日期     | 版本       | 修改内容 |
| ------ | -------- | ---------- | -------- |
| 刘金鑫 | 2019-8-8 | Version1.0 | 初稿     |

## **目  录**

[TOC]

## **1.** **概述**

### *1.1.* *前言*

本文档是【二手兔】系统的接口文档。

### *1.2.* *接口说明*

所有接口请求通过HTTP 请求，返回统一为JSON格式；

字符集：接口使用utf-8字符集。

大小写：接口参数名大小写敏感。

接口地址：未定（示例：http://47.105.176.98/est）。

端口：80。



### *1.3.* *登录说明*

客户端：使用token登录，用户登录后端返回一个32位的token字符串作为识别用户登录状态的唯一标识，前端调用部分（具体接口中会有说明）接口时需在参数上带token，**token需在header中传递**。

有效时间：暂定30分钟，即在用户没有任何操作的情况下30分钟后失去登录状态。

### *1.4.* *全局接口必传参数*

 

app端请求接口必传参数：时间戳、访问来源=0、手机型号、app版本、签名、token。

pc管理端请求接口必传：时间戳、访问来源=1。

 公共参数，token在header中传递，其他参数在body中传递，如果有特殊情况会在具体接口中说明。

| **参数名称** | **参数命名** | **说明**                      | **举例**   |
| ------------ | ------------ | ----------------------------- | ---------- |
| 访问来源类别 | source-type  | 用来识别请求来自app还是其他端 | 0:app,1:Pc |
| 时间戳       | timestamp    | 当前时间戳                    |            |

### *1.5.* *常用入参及出参的说明*

0：否，1：是

0：女，1：男

-1：通常没有意义

 

### *1.6.* *接口返回数据说明*

接口返回数据类型：JSON

接口功能操作状态返回

**正确的JSON返回结果：**

{

​     "code": "0",

​     "msg": "操作成功"

​     "data":{

​			        "id": 1,

​					"nam": "示例"

​				 }

}

**错误状态返回码：**

{

​     "code": "1",										//失败原因编号

​     "msg": "失败原因说明"					 //失败原因文字说明

}

具体见错误码表



## **2.** **错误列表**

(说明：错误列表暂定以下内容，根据项目开发的实际情况可能会有增加)

| code | msg              |
| ---- | ---------------- |
| 0    | 操作成功         |
| 1    | 操作失败         |
| 1001 | 请求参数错误     |
| 1002 | 登录失败         |
| 1003 | 验证码错误       |
| 1004 | 账号已存在       |
| 1005 | 账号不存在       |
| 1006 | 时间戳不能为空   |
| 1007 | 访问来源不能为空 |
| 2001 | 没有登录         |
| 2002 | 没有权限         |
| 2003 | 账号已被锁定     |
| 3001 | 找不到页面       |
| 3002 | 请求超时         |
| 3003 | 已被删除         |
| 3005 | 数据不存在       |
| 5    | 系统异常         |



 

##  3.接口列表

3.11.**获取商品类别信息**



### 3.1	首页

### 3.11.**获取商品类别信息**

调用接口：/api/home/classifyTree

请求方式：get

接口说明：返回首页商品分类列表数据，并包含相应分类下的品牌及品牌下的部分商品型号。

#### INPUT：无

| **参数名称** | **参数类型** | **说明** | 是否必传 |
| ------------ | ------------ | -------- | -------- |
|              |              |          |          |

#### OUTPUT

> data属性（数组）的数据格式为

| 字段         | 字段类型 | 字段说明                                                     |
| ------------ | -------- | ------------------------------------------------------------ |
| id           | 整型     | 商品类别id                                                   |
| classifyName | 字符串   | 商品类别名称                                                 |
| icon         | 字符串   | 类别小图标(手机：phone，平板电脑：pad，笔记本电脑：laptop，摄影摄像：camera，只能设备：ai) |
| bigIcon      | 字符串   | 类别大图标(手机：phone_big，平板电脑：pad_big，笔记本电脑：laptop_big，摄影摄像：camera，只能设备：ai_big) |
| brandList    | 数组     | 品牌列表                                                     |

> 品牌列表（数组）的数据格式为

| 字段      | 字段类型  | 字段说明     |
| --------- | --------- | ------------ |
| id        | 整型      | 品牌id       |
| brandName | 字符串    | 品牌名称     |
| logo      | 字符串url | 品牌logo     |
| modelList | 数组      | 商品型号列表 |

> 商品型号列表（数组）的数据格式为

| 字段      | 字段类型 | 字段说明     |
| --------- | -------- | ------------ |
| id        | 整型     | 商品型号id   |
| modelName | 字符串   | 商品型号名称 |

**示例：**

```
{
	"code": "0",
	"msg": "成功",
	"data": [{
		"id": 1,
		"classifyName": "手机",
		"icon": "phone",
		"bigIcon": "phone_big",
		"brandList": [{
			"id": 1,
			"brandName": "华为",
			"logo": "http://www.icon.png",
			"modelList": [{
				"id": 1,
				"modelName": "华为"
			}]
		
		}]
	}]
}
```



### 3.2	商品页

### 3.21. **商品列表**

调用接口：/api/model/search

请求方式：get

接口说明：返回商品型号列表的分页数据。

#### INPUT：

| **参数名称** | **参数类型** | **说明*                     | 是否必传 |
| ------------ | ------------ | --------------------------- | -------- |
| classifyId   | 整型         | 类别id                      | 否       |
| brandId      | 整型         | 品牌id                      | 否       |
| modelName    | 字符串       | 型号名称（输入框-模糊匹配） | 否       |
| pageNo       | 整型         | 页码（从1开始），默认1      | 否       |
| pageSize     | 整型         | 页长，默认20                | 否       |

#### OUTPUT

| 字段     | 字段类型 | 字段说明     |
| -------- | -------- | ------------ |
| pageNo   | 整型     | 当前页       |
| pageSize | 整型     | 页长         |
| total    | 整型     | 总数         |
| pages    | 整型     | 总页数       |
| list     | 数组     | 商品型号列表 |

> 商品型号列表（数组）的数据格式为

| 字段      | 字段类型  | 字段说明     |
| --------- | --------- | ------------ |
| id        | 整型      | 商品型号id   |
| modelName | 字符串    | 商品型号名称 |
| faceImg   | 字符串url | 商品图片     |
|           |           |              |



**示例：**

```
{
	"code": "0",
	"msg": "成功",
	"data": [{
		"pageNo": 1,
        "pageSize": 20,
        "total": 50,
        "list": [{
			"id": 1,
			"modelName": "华为Mate9",
			"faceImg": "http://www.mate9.png"
		}]
	}]
}
```



### 3.2	评估页面

### 3.31. 商品详情

调用接口：/api/model/{id}/detail

请求方式：get

接口说明：根据商品的型号id查询详细信息。

#### INPUT：

| **参数名称** | **参数类型** | **说明**              | **是否必传** |
| ------------ | ------------ | --------------------- | ------------ |
| id           | 整型         | 商品型号id,链接中传入 | 是           |

#### OUTPUT

| 字段       | 字段类型  | 字段说明     |
| ---------- | --------- | ------------ |
| id         | 整型      | 商品型号id   |
| modelName  | 字符串    | 商品型号名称 |
| faceImg    | 字符串url | 商品封面图片 |
| contentImg | 字符串url | 商品内容图片 |
|            |           |              |

**示例：**

```
{
	"code": "0",
	"msg": "成功",
	"data": {
        "id": 1,
        "modelName": "iphone X",
        "faceImg": "https://xxx/5a28b40bc60057c40a000005.png",
        "contentImg": "https://xxx/5a28b40bc60057c40a000005.png"
	}
}
```

### 3.32. 评估维度

调用接口：/api/evaluate/specList

请求方式：get

接口说明：根据商品分类查询评估维度信息。

#### INPUT：

| **参数名称** | **参数类型** | **说明**   | 是否必传 |
| ------------ | ------------ | ---------- | -------- |
| modelId      | 整型         | 商品型号id | 是       |

#### OUTPUT

> data属性（数组）的数据格式为

| **字段      | 字段类型  | 字段说明                    |
| ----------- | --------- | --------------------------- |
| id          | 整型      | 问题id                      |
| title       | 字符串    | 问题标题                    |
| isHint      | 整型      | 是否有提示信息（0:否,1:是） |
| hintTitle   | 字符串    | 提示信息标题                |
| hintInfo    | 字符串    | 提示信息（文字）            |
| hintImg     | 字符串url | 提示信息（图片）            |
| optionsList | 数组      | 规格属性选项列表            |

> optionsList规格属性详情列表 (数组) 数据格式如下

| **字段     | 字段类型  | 字段说明                    |
| ---------- | --------- | --------------------------- |
| id         | 整型      | 选项id                      |
| optionName | 字符串    | 选项名称                    |
| isHint     | 整型      | 是否有提示信息（0:否,1:是） |
| hintInfo   | 字符串    | 提示信息（文字）            |
| hintImg    | 字符串url | 提示信息（图片）            |

**示例：**

```
{
    "code": "0",
    "msg": "成功",
    "data": [
        {
            "id": 1,
            "title": "屏幕异常",
            "isHint": 1,
            "hintTitle": "提示信息标题...",
            "hintInfo": "屏幕已经损坏，需要更换电池才能解决。",
            "hintImg": "http://www.xxx.jpg",
            "optionsList": [
                {
                    "id": 1,
                    "optionName": "屏幕损坏",
                    "isHint": 1,
                    "hintInfo": "屏幕碎裂、磨损严重、划痕",
                    "hintImg": "http://www.hit.jpg",
                    "qid": 1
                }
          	]
    	}
    ]
}
```



### 3.33. 估价

调用接口：/api/evaluate/assess

请求方式：post

接口说明：根据用户选择的故障信息，对商品维修进行评估。

#### INPUT：

| **参数名称** | **参数类型** | **说明**                             | 是否必传 | **举例** |
| ------------ | ------------ | ------------------------------------ | -------- | -------- |
| modelId      | 整型         | 商品型号id                           | 是       |          |
| optionIds    | 字符串       | 选项ids（逗号拼接的评估信息选项ids） | 是       | 1,2,3    |
| token        | token        | 登陆后获取（header中传递）           | 是       |          |

#### OUTPUT

| 字段         | 字段类型 | 字段说明   |
| ------------ | -------- | ---------- |
| id           | 整型     | 评估信息id |
| modelId      | 整型     | 商品型号id |
| price        | 整型     | 评估价     |
| subscription | 整型     | 订金       |

**示例：**

```
{
	"code": "0",
	"msg": "成功",
	"data": {
		"id": 1,
		"modelId": 1,
		"price": 1000,
		"subscription": 100,
	}
}
```



### 3.3	商品页（订单确认页面）

### 3.31. 评估信息详情

调用接口：/api/evaluate/{id}/assessInfo

请求方式：get

接口说明：评估信息详情。

#### INPUT：

| **参数名称** | **参数类型** | **说明**   | 是否必传 |
| ------------ | ------------ | ---------- | -------- |
| id           | 整型         | 评估信息id | 是       |

#### OUTPUT

> data属性（对象）的数据格式为

| 字段         | 字段类型 | 字段说明     |
| ------------ | -------- | ------------ |
| id           | 整型     | 评估信息id   |
| price        | 浮点     | 评估价格     |
| subscription | 整型     | 订金         |
| model        | JSON对象 | 商品型号对象 |
| detailList   | 数组     | 评估详情数据 |

> model属性（对象）的数据格式为

| 字段      | 字段类型  | 字段说明   |
| --------- | --------- | ---------- |
| id        | 整型      | 商品型号id |
| modelName | 字符串    | 商品名称   |
| topPrice  | 浮点      | 最高回收价 |
| faceImg   | 字符串url | 封面图片   |

> detailList属性（数组）的数据格式为

| 字段       | 字段类型 | 字段说明     |
| ---------- | -------- | ------------ |
| id         | 整型     | 评估详情id   |
| optionId   | 整型     | 故障选项id   |
| optionName | 字符串   | 故障选项名称 |
| maflId     | 整型     | 故障id       |

**示例：**

```
{
    "code": "0",
    "msg": "成功",
    "data": {
        "id": 23,
        "modelId": 1,
        "subscription": 49.00,
        "price": 490.00,
        "model": {
            "id": 1,
            "modelName": "iphone X",
            "topPrice": 800.00,
            "faceImg": "https://5a28b40bc60057c40a000005.png"
        },
        "detailList": [
            {
                "id": 10,
                "optionId": 1,
                "optionName": "屏幕损坏",
                "malfId": 1
                
            }
        ]
    }
}
```

### 3.32. 维修订单详情

调用接口：/api/order/maintain/detail/{orderNo}

请求方式：get

接口说明：维修订单详情。

#### INPUT：

| **参数名称** | **参数类型** | **说明**                   | 是否必传 |
| ------------ | ------------ | -------------------------- | -------- |
| orderNo      | 字符串       | 维修订单编号               | 是       |
| token        | token        | 登陆后获取（header中传递） | 是       |

#### OUTPUT

> data属性（数组）的数据格式为

| 字段           | 字段类型 | 字段说明                                  |
| -------------- | -------- | ----------------------------------------- |
| id             | 整型     | 订单id                                    |
| orderNo        | 字符串   | 订单编号                                  |
| price          | 浮点     | 实际交易价格                              |
| status         | 整型     | 订单状态                                  |
| statusDesc     | 字符串   | 订单状态说明                              |
| payTimeStr     | 字符串   | 支付时间                                  |
| payChannel     | 整型     | 支付途径（1:现金,2:刷卡,3:支付宝,4:微信） |
| payChannelDesc | 字符串   | 支付途径说明                              |
| model          | 对象json | 商品型号信息                              |
| evaluate       | 对象json | 评估信息                                  |
| flowList       | 数组     | 订单流水信                                |

> model属性（JSON对象）的数据格式为

| id         | 整型   | 商品型号id   |
| ---------- | ------ | ------------ |
| modelName  | 字符串 | 商品型号名称 |
| faceImg    | 字符串 | 封面图片     |
| contentImg | 字符串 | 内容图片     |

> evaluate属性（JSON对象）的数据格式为

| id                 | 整型   | 商品型号id       |
| ------------------ | ------ | ---------------- |
| modelId            | 字符串 | 商品型号名称     |
| price              | 浮点   | 自评价格         |
| evaluateDetailList | 数组   | 问题自评详细信息 |

> evaluateDetailList属性（数组）的数据格式为

| id         | 整型   | 自评问题选项id   |
| ---------- | ------ | ---------------- |
| optionName | 字符串 | 自评问题选项名称 |

> flowList属性（数组）的数据格式为

| id              | 整型   | 商品型号id   |
| --------------- | ------ | ------------ |
| orderNo         | 字符串 | 商品型号名称 |
| orderStatus     | 整型   | 状态编号     |
| orderStatusDesc | 字符串 | 状态说明     |
| operationName   | 字符串 | 操作人姓名   |
| operationTime   | 字符串 | 操作时间     |

**示例：**

```
{
    "code": "0",
    "msg": "成功",
    "data": {
        "id": 1,
        "serialNo": null,
        "orderNo": "6498f4bb19e04f5a975aa3e01764d886",
        "price": 1000.00,
        "status": 1,
        "statusDesc": "完成",
        "payTimeStr": "2019-08-15 04:01:01",
        "payChannel": 3,
        "model": {
            "id": 1,
            "modelName": "iphone X",
            "faceImg": "http://www.faceImg.png",
            "contentImg": "http://www.contentImg.png"
        },
        "evaluateVo": {
            "id": 5,
            "modelId": 1,
            "price": 540.00,
            "evaluateDetailList": [
                {
                    "id": 10,
                    "optionName": "屏幕损坏"
                }      
            ]            
        },
        "flowList": [
            {
                "id": 2,
                "orderNo": "6498f4bb19e04f5a975aa3e01764d886",
                "orderStatus": 8,
                "orderStatusDesc": "支付尾款",
                "operationUId": 1,
                "operationName": "张三",
                "operationTime": "2019-08-15 04:01:01"
            },
            {
                "id": 10,
                "orderNo": "6498f4bb19e04f5a975aa3e01764d886",
                "orderStatus": 10,
                "orderStatusDesc": "完成",
                "operationUId": 1,
                "operationName": "张三",
                "operationTime": "2019-08-19 04:01:01"
            }
        ]
    }
}
```

### 



### 3.33. 下单--维修

调用接口：/api/order/maintain/submit

请求方式：post

接口说明：维修订单提交，预约。

#### INPUT：

| **参数名称**     | **参数类型** | **说明**                   | 是否必传 | **举例**                                                     |
| ---------------- | ------------ | -------------------------- | -------- | ------------------------------------------------------------ |
| evaluateId       | 整型         | 评估信息id                 | 是       |                                                              |
| phone            | 字符串       | 预约手机号                 | 是       |                                                              |
| sms              | 字符串       | 下单验证码                 | 是       | 0000                                                         |
| adress           | 字符串       | 预约上门地址               | 是       | 北京市海淀区中关村大街18号互联网教育创新中心1009，好时光科技有限公司 |
| appintDate       | 字符  串     | 预约日期                   | 是       | 2019-08-12                                                   |
| temporalInterval | 整型         | 预约时间区间               | 是       | 预约时间<br />（1:上午,2:中午,3:下午,4:晚上）                |
| token            | token        | 登陆后获取（header中传递） | 是       |                                                              |

#### OUTPUT

| 字段    | 字段类型 | 字段说明 |
| ------- | -------- | -------- |
| id      | 整型     | 订单id   |
| orderNo | 字符串   | 订单编号 |

**示例：**

```
{
	"code": "0",
	"msg": "成功",
	"data": {
		"orderNo": "2019090313192837460000000012"
	}
}
```



### 3.34. 支付宝支付（同步请求）

调用接口：/api/pay/aliPay

请求方式：post

接口说明：支付宝支付订单下单成功会唤起支付宝支付页面。

#### INPUT：

| **参数名称** | **参数类型** | **说明**                   | 是否必传 |
| ------------ | ------------ | -------------------------- | -------- |
| orderNo      | 字符串       | 订单编号                   | 是       |
| token        | token        | 登陆后获取（header中传递） | 是       |

#### OUTPUT

| 字段 | 字段类型 | 字段说明 |
| ---- | -------- | -------- |
|      |          |          |



### 3.35. 支付宝回调（异步---非前端接口）

调用接口：/api/pay/aliPay/notify

请求方式：post

接口说明：支付宝支付订单下单成功后的回调接口，通知支付结果

#### INPUT：

| **参数名称** | **参数类型** | **说明** | **举例** |
| ------------ | ------------ | -------- | -------- |
|              |              |          |          |

#### OUTPUT

| 字段 | 字段类型 | 字段说明 |
| ---- | -------- | -------- |
|      |          |          |

**示例：**

```
跳转到成功页面
```



### 3.35.  支付宝回调（同步---非前端接口）

调用接口：/api/pay/aliPay/return

请求方式：get

接口说明：支付宝支付订单下单成功后的回调接口，通知支付结果。

#### INPUT：

| **参数名称** | **参数类型** | **说明** | **举例** |
| ------------ | ------------ | -------- | -------- |
|              |              |          |          |

#### OUTPUT

| 字段 | 字段类型 | 字段说明 |
| ---- | -------- | -------- |
|      |          |          |

**示例：**

```

```



### 3.4	注册、登录页面

### 3.41. 发送短信验证码

调用接口：/api/sms/verifyCode

请求方式：post

接口说明：获取短信验证码，60秒有效，60秒内不会重复为同一个手机号发送相同类型的短信验证码。

#### INPUT：

| **参数名称** | **参数类型** | **说明**                                                     | 是否必传 |
| ------------ | ------------ | ------------------------------------------------------------ | -------- |
| phone        | 字符串       | 手机号                                                       | 是       |
| codeType     | 整型         | 验证码类型<br />0：注册、登录验证码<br />1：修改密码<br />2：订单状态通知信息<br />3：下单验证码<br /> | 是       |

#### OUTPUT

| 字段 | 字段类型 | 字段说明 |
| ---- | -------- | -------- |
|      |          |          |

**示例：**

```
{
	"code": "0",
	"msg": "成功"
}
```

### 

### 3.43. 注册、登录（手机验证码）

调用接口：/api/users/login/sms

请求方式：post

接口说明：手机验证码注册或登录接口。

#### INPUT：

| **参数名称** | **参数类型** | **说明**   | **是否必传** |
| ------------ | ------------ | ---------- | ------------ |
| phone        | 字符串       | 手机号     | 是           |
| sms          | 字符串       | 登录验证码 | 是           |

#### OUTPUT

| 字段  | 字段类型 | 字段说明 |
| ----- | -------- | -------- |
| token | 字符串   | 登录标识 |

**示例：**

```
{
    "code": "0",
    "msg": "成功",
    "data": {
        "token": "70fe12228b39432eb92ecddfc64006de"
    }
}
```





### 3.44. 注册、登录（微信登录--同步接口）

调用接口：/api/users/login/wechat

请求方式：get

接口说明：微信注册或登录接口。

#### INPUT：

| **参数名称** | **参数类型** | **说明** | **举例** |
| ------------ | ------------ | -------- | -------- |
|              |              |          |          |

#### OUTPUT

| 字段  | 字段类型 | 字段说明 |
| ----- | -------- | -------- |
| token | 字符串   | 登录标识 |

**示例：**

```
token在重定向url中拼接返回

```





### 3.45. 微信回调接口（---非前端接口）

调用接口：/api/users/wechat/callback

请求方式：post

接口说明：用户授权后，微信平台回调我们的接口，绑定完善、微信用户信息。

#### INPUT：

| **参数名称** | **参数类型** | **说明** | **举例** |
| ------------ | ------------ | -------- | -------- |
|              |              |          |          |

#### OUTPUT

| 字段  | 字段类型 | 字段说明 |
| ----- | -------- | -------- |
| token | 字符串   | 登录标识 |

**示例：**

```
{
	"code": "0",
	"msg": "成功",
}
```



### 3.46. 获取用户信息

调用接口：/api/users/info

请求方式：post

接口说明：获取微信用户的头像、昵称等信息。

#### INPUT：

| **参数名称** | **参数类型** | **说明** | 是否必传 |
| ------------ | ------------ | -------- | -------- |
| token        | 字符串       | 登录标识 | 是       |

#### OUTPUT

| 字段     | 字段类型             | 字段说明 |
| -------- | -------------------- | -------- |
| id       | 整数                 |          |
| account  | 字符串               | 账号     |
| userName | 字符串               | 昵称     |
| sex      | 整形（0：女，1：男） | 性别     |
| faceUrl  | 字符串               | 头像     |

**示例：**

```
{
    "code": "0",
    "msg": "成功",
    "data": {
        "id": 5,
        "account": "13521214507",
        "userName": "13521214507",
        "sex": null,
        "faceUrl": null,
        "token": "a0039085a1b3487ba290ee5001959173"
    }
}
```

### 3.47. 登出

调用接口：/api/users/logout

请求方式：post

接口说明：退出登录。

#### INPUT：

| **参数名称** | **参数类型** | **说明**                   | **举例** |
| ------------ | ------------ | -------------------------- | -------- |
| token        | token        | 登陆后获取（header中传递） | 是       |

#### OUTPUT

> 无

| 字段 | 字段类型 | 字段说明 |
| ---- | -------- | -------- |
|      |          |          |

**示例：**

```
{
	"code": "0",
	"msg": "成功",
}
```


